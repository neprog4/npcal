function npInitCal(e,t){var n="object"==typeof e?e:document.getElementById(e);n.className="npContainer","static"==window.getComputedStyle(n).getPropertyValue("position")&&(n.style.position="relative");var r=document.createElement("div");if(r.className="npPicker",r.setAttribute("onclick","npShowCal(this);"),n.appendChild(r),null==t)(t={}).days=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],t.months=["January","February","March","April","May","Jun","July","August","September","Oktober","November","December"],t.delimiter=0,t.format=0;else{if(null==t.days||null==t.days||7!=t.days.length)t.days=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];else for(var a=t.days,l=0;l<a.length;l++)a[l].length>3&&(t.days[l]=a[l].toString().substr(0,3));(null==t.delimiter||null==t.delimiter||t.delimiter<0||t.delimiter>2)&&(t.delimiter=0),(null==t.format||null==t.format||t.format<0||t.format>3)&&(t.format=0),null!=t.months&&null!=t.months&&12==t.months.length||(t.months=["January","February","March","April","May","Jun","July","August","September","Oktober","November","December"])}n.setAttribute("np-param",JSON.stringify(t));var i=n.getAttribute("np-value");i=null==i||""==i?npRetDateString(n):npRetVerDate(n,i),n.setAttribute("np-value",i),r.innerHTML=i,npGenCal(n)}function npGenCal(e){var t=JSON.parse(e.getAttribute("np-param")),n=npGetDMY(e),r=document.createElement("div");r.className="npCalendar";var a=document.createElement("div");a.className="npCalHeader npInbox";var l=document.createElement("table");l.setAttribute("cellpadding","0"),l.setAttribute("cellspacing","0"),l.className="npInbox",(d=(i=l.insertRow()).insertCell()).innerHTML=t.months[n.m],d.setAttribute("np-month",n.m),d.setAttribute("onclick","npShowMonth(this);"),(d=i.insertCell()).innerHTML="&#9664;",d.setAttribute("onclick","npChYear(this,0);"),(d=i.insertCell()).innerHTML=n.y,d.setAttribute("np-year",n.y),d.setAttribute("onclick","npChYear(this,2);"),(d=i.insertCell()).innerHTML="&#9654;",d.setAttribute("onclick","npChYear(this,1);"),a.appendChild(l),r.appendChild(a),(a=document.createElement("div")).className="npCalDaysHdr npInbox",(l=document.createElement("table")).setAttribute("cellpadding","0"),l.setAttribute("cellspacing","0"),l.className="npInbox",l.setAttribute("style","height:100%;");for(var i=l.insertRow(),p=0;p<t.days.length;p++)(d=i.insertCell()).innerHTML=t.days[p];a.appendChild(l),r.appendChild(a);var s=document.createElement("div");s.className="npCalDaysCnt npInbox",s.setAttribute("np-day",n.d);var o=document.createElement("table");o.setAttribute("cellspacing","2"),o.className="npInbox";for(p=0;p<6;p++){i=o.insertRow();for(var u=0;u<7;u++){var d;(d=i.insertCell()).setAttribute("onclick","npSelDate(this);"),d.className=5==u?"npCalDay6":6==u?"npCalDay7":"npCalDay"}}s.appendChild(o),r.appendChild(s);var c=document.createElement("div");c.className="npMonth";for(p=0;p<t.months.length;p++){var m=document.createElement("div");m.innerHTML=t.months[p],m.className="npMonthBtn",m.setAttribute("np-monthValue",p),m.setAttribute("onclick","npSelMonth(this);"),c.appendChild(m)}r.appendChild(c),e.appendChild(r),npShowMD(e)}function npSelDate(e){var t=e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode,n=parseInt(t.querySelector("[np-year]").getAttribute("np-year")),r=parseInt(t.querySelector("[np-month]").getAttribute("np-month")),a=parseInt(e.innerHTML);t.querySelector("[np-day]").setAttribute("np-day",a);var l=npRetDateString(t,a,r+1,n);t.querySelector(".npPicker").innerHTML=l,t.setAttribute("np-value",l),t.querySelector(".npCalendar").style.display="none"}function npChYear(e,t){(null==t||t<0||t>2)&&(t=2);var n=e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode,r=e.parentNode.cells[2],a=parseInt(r.getAttribute("np-year"));switch(t){case 0:a-=1;break;case 1:a+=1;break;case 2:a=(new Date).getFullYear()}r.innerHTML=a,r.setAttribute("np-year",a),npShowMD(n)}function npShowMonth(e){var t=e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode,n=t.querySelector("[np-month]").getAttribute("np-month"),r=t.getElementsByTagName("div")[5];if(""==r.style.display||"none"==r.style.display){r.style.display="block";for(var a=r.getElementsByTagName("div"),l=0;l<a.length-1;l++)a[l].getAttribute("np-monthValue")==n?a[l].style.fontWeight="bold":a[l].style.fontWeight="normal"}else r.style.display="none"}function npSelMonth(e){var t=e.parentNode.parentNode.parentNode,n=t.querySelector("[np-month]");n.innerHTML=e.innerHTML,n.setAttribute("np-month",e.getAttribute("np-monthValue")),e.parentNode.style.display="none",npShowMD(t)}function npShowMD(e){var t=npGetDMY(e),n=new Date,r=parseInt(e.querySelector("[np-month]").getAttribute("np-month")),a=parseInt(e.querySelector("[np-year]").getAttribute("np-year")),l=new Date(a,r+1,0).getDate(),i=new Date(a,r,1).getDay();0==i&&(i=7);for(var p=e.querySelector("[np-day]").getElementsByTagName("td"),s=1,o=0;o<p.length;o++)o>=i-1&&o<=i+l-2?(p[o].style.visibility="visible",p[o].innerHTML=s<10?"0"+s:s,p[o].className=o%7==5?"npCalDay6":o%7==6?"npCalDay7":"npCalDay",r==t.m&&a==t.y&&s==t.d?p[o].className="npSelDay":r==n.getMonth()&&a==n.getFullYear()&&s==n.getDate()&&(p[o].className="npCurrDay"),s+=1):p[o].style.visibility="hidden"}function npGetDMY(e){var t={},n=JSON.parse(e.getAttribute("np-param")),r=e.getAttribute("np-value").toString().split([".","-","/"][n.delimiter]);switch(n.format){case 0:t.d=parseInt(r[0]),t.m=parseInt(r[1])-1,t.y=parseInt(r[2]);break;case 1:t.d=parseInt(r[2]),t.m=parseInt(r[1])-1,t.y=parseInt(r[0]);break;case 2:t.d=parseInt(r[1]),t.m=parseInt(r[2])-1,t.y=parseInt(r[0]);break;case 3:t.d=parseInt(r[1]),t.m=parseInt(r[0])-1,t.y=parseInt(r[2])}return t}function npRetVerDate(e,t){var n,r,a,l,i,p=JSON.parse(e.getAttribute("np-param"));if(null==(n=t.indexOf(".")>-1?t.toString().split("."):t.indexOf("-")>-1?t.toString().split("-"):t.indexOf("/")>-1?t.toString().split("/"):null))i=npRetDateString(e);else{switch(null!=p.format&&null!=p.format||(p.format=0),p.format){case 0:r=parseInt(n[0]),a=parseInt(n[1]),l=parseInt(n[2]);break;case 1:r=parseInt(n[2]),a=parseInt(n[1]),l=parseInt(n[0]);break;case 2:r=parseInt(n[1]),a=parseInt(n[2]),l=parseInt(n[0]);break;case 3:r=parseInt(n[1]),a=parseInt(n[0]),l=parseInt(n[2])}if(r<1||a<1||a>12||l<0)i=npRetDateString(e);else i=r>new Date(l,a-1,0).getDate()?npRetDateString(e):npRetDateString(e,r,a,l)}return i}function npRetDateString(e,t,n,r){var a="",l=JSON.parse(e.getAttribute("np-param")),i=[".","-","/"][l.delimiter];if(null==t||null==n||null==r){var p=new Date;t=p.getDate(),n=p.getMonth()+1,r=p.getFullYear()}var s=t<10?"0"+t.toString():t.toString(),o=n<10?"0"+n.toString():n.toString();switch(l.format){case 0:a=s+i+o+i+r.toString();break;case 1:a=r.toString()+i+o+i+s;break;case 2:a=r.toString()+i+s+i+o;break;case 3:a=o+i+s+i+r.toString()}return a}function npShowCal(e){var t=e.getBoundingClientRect(),n=e.parentNode.getElementsByTagName("div")[1];if(""==n.style.display||"none"==n.style.display){n.style.display="block";var r=t.top+t.height+268>window.innerHeight?-270:t.height+2,a=t.left+254>window.innerWidth?e.offsetWidth-254:0;n.style.top=r.toString()+"px",n.style.left=a.toString()+"px",npShowMD(e.parentNode)}else{npSetCalendarClosed(e.parentNode),n.style.display="none",e.parentNode.getElementsByTagName("div")[5].style.display="none"}}function npSetCalendarClosed(e){var t=npGetDMY(e),n=JSON.parse(e.getAttribute("np-param"));e.querySelector("[np-day]").setAttribute("np-day",t.d),e.querySelector("[np-month]").setAttribute("np-month",t.m),e.querySelector("[np-month]").innerHTML=n.months[t.m],e.querySelector("[np-year]").setAttribute("np-year",t.y),e.querySelector("[np-year]").innerHTML=t.y}Element.prototype.setDate=function(e){if(null!=this.getAttribute("np-value")){var t=npRetVerDate(this,e);this.setAttribute("np-value",t),this.querySelector(".npPicker").innerHTML=t,npSetCalendarClosed(this)}},Element.prototype.setYMD=function(e,t,n){if(null!=this.getAttribute("np-value")&&t>=1&&t<=12){var r=new Date(e,t,0).getDate();n>r&&(n=r);new Date(e,t-1,n);var a=npRetDateString(this,n,t,e);this.setAttribute("np-value",a),this.querySelector(".npPicker").innerHTML=a,npSetCalendarClosed(this)}},Element.prototype.getDate=function(){return this.getAttribute("np-value")},Element.prototype.getYMD=function(){if(null!=this.getAttribute("np-value")){var e={},t=npGetDMY(this);return e.day=t.d,e.month=t.m+1,e.year=t.y,e}};
